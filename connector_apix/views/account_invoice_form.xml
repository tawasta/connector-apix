<?xml version="1.0" encoding="UTF-8"?>
<odoo>
    <record id="invoice_form" model="ir.ui.view">
        <field name="name">APIX EDI Invoice</field>
        <field name="model">account.invoice</field>
        <field name="inherit_id" ref="account_invoice_transmit_method.invoice_form"/>
        <field name="arch" type="xml">

            <field name="date_invoice" position="after">
                <field name="date_einvoice_sent" attrs="{'invisible': [('date_einvoice_sent', '=', False)]}" />
            </field>

            <!-- Add an eInvoice sending buttons -->
            <!-- Use ambiguous "button[1]" to support replacing or removing header buttons in other modules -->
            <xpath expr="//button[1]" position="after">

                <button name="action_einvoice_send"
                        type="object"
                        string="Send eInvoice"
                        class="oe_highlight"
                        groups="account.group_account_invoice"
                        attrs="{'invisible':[
                        '|', '|',
                        ('date_einvoice_sent', '!=', False),
                        ('transmit_method_code', 'not in', ('einvoice')),
                        ('state', 'not in', ['open', 'paid']),
                        ]}"
                />

                <button name="action_einvoice_send"
                        type="object"
                        string="Send via printing service"
                        class="oe_highlight"
                        groups="account.group_account_invoice"
                        attrs="{'invisible':[
                        '|', '|',
                        ('date_einvoice_sent', '!=', False),
                        ('transmit_method_code', 'not in', ('printing_service')),
                        ('state', 'not in', ['open', 'paid']),
                        ]}"
                />
            </xpath>
        </field>
    </record>

    <record id="invoice_form_admin" model="ir.ui.view">
        <field name="name">APIX EDI Invoice Admin</field>
        <field name="model">account.invoice</field>
        <field name="groups_id" eval="[(4, ref('account.group_erp_manager'))]"/>
        <field name="inherit_id" ref="account.invoice_form"/>
        <field name="arch" type="xml">
            <xpath expr="//page[last()]" position="after">
                <page name="apix_bindings" string="APIX" groups="base.group_system">
                    <field name="apix_bind_ids">
                        <tree create="false" delete="false">
                            <field name="backend_id" readonly="1"/>
                            <field name="odoo_id" readonly="1"/>
                            <field name="apix_batch_id" readonly="1"/>
                            <field name="apix_accepted_document_id" readonly="1"/>
                            <field name="apix_cost_in_credits" readonly="1"/>
                        </tree>
                    </field>
                </page>
            </xpath>
        </field>
    </record>

    <record id="invoice_supplier_form_admin" model="ir.ui.view">
        <field name="name">APIX EDI Invoice Admin</field>
        <field name="model">account.invoice</field>
        <field name="groups_id" eval="[(4, ref('account.group_system'))]"/>
        <field name="inherit_id" ref="account.invoice_supplier_form"/>
        <field name="arch" type="xml">
            <xpath expr="//page[last()]" position="after">
                <page name="apix_bindings" string="APIX" groups="base.group_erp_manager">
                    <field name="apix_bind_ids">
                        <tree create="false" delete="false">
                            <field name="backend_id" readonly="1"/>
                            <field name="odoo_id" readonly="1"/>
                            <field name="apix_batch_id" readonly="1"/>
                            <field name="apix_accepted_document_id" readonly="1"/>
                            <field name="apix_cost_in_credits" readonly="1"/>
                        </tree>
                    </field>
                </page>
            </xpath>
        </field>
    </record>
</odoo>